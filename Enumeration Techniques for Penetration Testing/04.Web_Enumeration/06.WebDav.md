# WebDAV Enumeration

**WebDAV (Web Distributed Authoring and Versioning)** enumeration is the process of discovering accessible resources, capabilities, and potential vulnerabilities on a WebDAV-enabled server.  
This guide outlines techniques and tools used to interact with and test WebDAV services for security weaknesses.

---

## Initial Reconnaissance


    nmap -v -sT -sV -A -O -p 80 192.168.1.103
    dirsearch -u http://192.168.1.36/ -t 50
## WebDAV Enumeration Techniques
### 1. Identify WebDAV Support
Use the OPTIONS HTTP method to determine whether WebDAV is enabled.

    curl -v -X OPTIONS http://192.168.1.36/webdav/
### Request

    OPTIONS /webdav/ HTTP/1.1
    Host: 192.168.1.36
    Cache-Control: max-age=0
    Accept-Language: en-GB,en;q=0.9
    Upgrade-Insecure-Requests: 1
    User-Agent: Mozilla/5.0 (X11; Linux x86_64)
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    Accept-Encoding: gzip, deflate, br
    Connection: keep-alive
### Response

    HTTP/1.1 200 OK
    Date: Thu, 24 Apr 2025 10:50:01 GMT
    Server: Apache/2.4.62 (CentOS Stream) OpenSSL/3.2.2
    DAV: 1,2
    DAV: <http://apache.org/dav/propset/fs/1>
    MS-Author-Via: DAV
    Allow: OPTIONS, GET, HEAD, POST, DELETE, TRACE, PROPFIND, PROPPATCH, COPY, MOVE, LOCK, UNLOCK
    Content-Length: 0
    Keep-Alive: timeout=5, max=100
    Connection: Keep-Alive
    Content-Type: httpd/unix-directory

Look for WebDav-related HTTP methods in thr Allow header

- PROPFIND
- PROPPATCH
- MKCOL
- COPY
- MOVE
- LOCK
- UNLOCK

Presence of these methods confirms WebDAV support.

### Test File Upload (PUT)

    curl -v -X PUT -d "<?php phpinfo(); ?>" http://192.168.1.36/webdav/phpinfo.php

### 2. Use Nmap for Deeper Analysis
- Enumerate HTTP methods:

      nmap -p 80 --script=http-methods.nse \

- --script-args http-methods.url-path='/webdav/' 192.168.1.36
Full aggressive scan:

      nmap -v -sT -sV -A -O -p 80 \
      --script=http-methods.nse \
      --script-args http-methods.url-path='/webdav/' 192.168.1.36

### 3. Test With Davtest
Install:

    apt install davtest

Run:
        
    davtest -url http://192.168.1.36/webdav/

With authentication:

    davtest -url http://192.168.1.36/webdav/ -auth username:password
Examples:

    davtest -url http://192.168.1.40/test/ -auth dev:123
    davtest -url http://192.168.1.35/webdav/ -auth dev:1234

Davtest checks for:
- Writable directories
- Upload execution
- File validation bypasses

### 4. Use a WebDAV Client (Cadaver)
Cadaver is an interactive CLI client for WebDAV.

#### Installation
    Debian / Ubuntu
    apt install cadaver

#### RHEL / CentOS
    yum install cadavere
    cadaver http://192.168.1.36/webdav/
    
### Common Commands
      ls              # List contents
      put file.txt    # Upload file
      get file.txt    # Download file
      delete file.txt # Delete file
      mkdir dir       # Create directory

### 5. Brute Force Authentication (If Protected)
Use Hydra to test weak credentials:

    hydra -l username -P /path/to/passwords.txt -s 80 -f target-ip http-head "/webdav"
#### Example:
    hydra -L users.txt -P /usr/share/seclists/Passwords/darkweb2017-top1000.txt \
    -s 80 -f 192.168.1.36 http-head "/webdav"

Useful when encountering HTTP Basic/Digest Authentication.

### 6. Manual Upload and Deletion (Writable Test)
#### Upload:
    curl -T test.txt http://target-ip/webdav/test.txt

#### Delete:
    curl -X DELETE http://target-ip/webdav/test.txt
Authenticated upload and deletion:

    curl -u username:password -T test.txt http://target-ip/webdav/
    curl -u username:password -X DELETE http://target-ip/webdav/test.txt
### 7. Check for Misconfigured Access Controls
Indicators of weak configuration:

- Anonymous upload or delete access
- Execution of .php, .asp, .aspx files
- No authentication prompt
- Directory browsing enabled

### Potential Impact:
ðŸš¨ Remote Code Execution (RCE)

- What to Look For
- Writable directories
- Executable file types supported
- Directory listing exposed
- Anonymous or unauthenticated access
- Weak or guessable credentials
- Over-permissive permissions (e.g., chmod 777)
