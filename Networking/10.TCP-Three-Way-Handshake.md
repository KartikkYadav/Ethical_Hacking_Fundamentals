# TCP Three-Way Handshake Process

## TCP Three-Way Handshake Process Explained

The **TCP three-way handshake** is the fundamental mechanism used to establish a reliable TCP connection between a client and a server. It ensures both sides are synchronized and ready to communicate.

---

**Illustration: TCP Three-Way Handshake**

<img width="866" height="453" alt="Screenshot From 2025-08-07 16-46-46" src="https://github.com/user-attachments/assets/ccc36923-e44c-467c-be43-2f4e55206d07" />




---

### Step 1: SYN (Synchronize) Packet

- The client initiates the connection by sending a TCP packet with the `SYN` flag set.
- This packet contains an **Initial Sequence Number (ISN)** chosen by the client, which will be used to track the order of data it sends.
- **Purpose:** Request to open a connection.

---

### Step 2: SYN-ACK (Synchronize-Acknowledge) Packet

- The server responds to the client’s SYN packet with a TCP packet that has both `SYN` and `ACK` flags set.
- The `SYN` flag means the server agrees to establish a connection.
- The `ACK` acknowledges the client’s ISN by setting the acknowledgment number to `client’s ISN + 1`.
- The server also includes its own ISN for the connection.

---

### Step 3: ACK (Acknowledge) Packet

- The client responds back with a TCP packet with the `ACK` flag set.
- The acknowledgment number is set to `server’s ISN + 1`, acknowledging the server’s SYN-ACK.
- After sending this packet, the connection is established, and both sides can begin data transmission.

---

## Why Is the Three-Way Handshake Important?

- **Reliability:** Both client and server confirm they are ready to communicate, synchronize their sequence numbers, and establish connection parameters.
- **Connection Establishment:** Without this handshake, TCP wouldn’t reliably ensure both parties are prepared, risking lost or misordered data.
- **Duplicate Data Prevention:** Sequence and acknowledgment numbers help manage data order, ensuring duplicates are detected and avoided.

---

## Summary Table

| Step | Packet Type | Flags Set   | Purpose                                         |
|------|-------------|-------------|-------------------------------------------------|
| 1    | SYN         | SYN         | Client requests connection; sends ISN           |
| 2    | SYN-ACK     | SYN + ACK   | Server acknowledges client, sends its own ISN    |
| 3    | ACK         | ACK         | Client acknowledges server’s SYN-ACK             |



# TLS Handshake Process

The TLS (Transport Layer Security) handshake is a crucial process that establishes a secure, encrypted connection between a client and a server. This handshake involves several steps where both parties agree on protocols, authenticate each other, and generate session keys for encryption.

---

## TLS Handshake Process Steps

1. **Client Hello**
    - The client sends a "Client Hello" message to the server.
    - This message contains the TLS version supported by the client, a list of supported cipher suites (cryptographic algorithms), and a random value called the **Client Random**.

2. **Server Hello**
    - The server responds with a "Server Hello" message.
    - This message includes the TLS version the server selected (from the client's list), the cipher suite chosen, and a random value called the **Server Random**.
    - The server also sends its **digital certificate**, which contains its public key and identity information to authenticate itself.

3. **Server Authentication and Certificate Verification**
    - The client verifies the server's certificate against trusted Certificate Authorities (CAs) to ensure the server is authentic.
    - If the server requires client authentication, it also requests the client's certificate.

4. **Client Key Exchange (Pre-Master Secret)**
    - The client generates a **pre-master secret**, a random number used to create the master secret.
    - The client encrypts this pre-master secret with the server's public key (from the certificate) and sends it to the server.

5. **Server Decrypts Pre-Master Secret**
    - The server uses its private key to decrypt the pre-master secret.
    - Both client and server now have the pre-master secret.

6. **Session Keys Generation**
    - Using the **Client Random**, **Server Random**, and **pre-master secret**, both parties independently compute the same **master secret**.
    - From the master secret, symmetric **session keys** are derived for encrypting and decrypting the data.

7. **Change Cipher Spec**
    - The client sends a "Change Cipher Spec" message, indicating that future messages will be encrypted using the negotiated session key.
    - The client then sends a "Finished" message encrypted with the session key, proving the handshake's integrity.

8. **Server Change Cipher Spec and Finished**
    - The server sends its own "Change Cipher Spec" message and an encrypted "Finished" message.
    - Once the client decrypts and verifies this, the handshake is complete.

9. **Secure Encrypted Communication Begins**
    - Both parties now exchange data encrypted with the symmetric session keys for confidentiality and integrity.

---

## Summary Table of TLS Handshake Steps

| Step                                   | Description                                                                  |
|-----------------------------------------|------------------------------------------------------------------------------|
| 1. Client Hello                        | Client sends supported TLS version, cipher suites, and Client Random         |
| 2. Server Hello                        | Server responds with selection and Server Random, sends certificate          |
| 3. Certificate Validation               | Client authenticates server's certificate                                    |
| 4. Client Key Exchange                  | Client sends encrypted pre-master secret                                     |
| 5. Server Decrypts Secret               | Server decrypts pre-master secret                                            |
| 6. Session Key Creation                 | Both create master secret and session keys                                   |
| 7. Client Change Cipher Spec & Finished | Client signals encryption readiness, sends finished message                  |
| 8. Server Change Cipher Spec & Finished | Server signals encryption readiness, sends finished message                  |
| 9. Encrypted Communication              | Secure data exchange begins                                                  |

---

## Notes

- **TLS 1.3 simplifies this process by reducing round trips and eliminating some steps, improving speed and security.**
- The TLS handshake ensures **confidentiality, integrity, and authentication between client and server during communication**.

This handshake process is fundamental in securing HTTPS connections, email servers, VPNs, and other systems requiring secure communication over networks.


