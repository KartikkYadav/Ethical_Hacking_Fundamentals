# Host-Discovery

## Nmap Host Discovery

Host discovery is the first essential step in network reconnaissance with Nmap. It helps identify live targets before performing more intensive port scans, optimizing scan time and resources. Below is an expanded guide with common and advanced Nmap host discovery techniques, commands, and tips, formatted in Markdown.

---

### 1. List Scan — List Targets Only

Lists targets without sending packets, useful for validation or inventory purposes.

    nmap -v -sL 192.168.1.1/24


---

### 2. Ping Scan — Check Which Hosts Are Up (No Port Scan)

Use this to detect live hosts without probing ports.

    nmap -v -sn 192.168.1.1/24
    
    nmap -sn 192.168.1.1/24


Filter output to show only live hosts:

    nmap -sn 192.168.1.1/24 | grep "scan report" | cut -f 5 -d " " > live_hosts.txt


Save output in multiple formats:

    nmap -v -sn 192.168.1.1/24 -oA /tmp/mynetwork

    cat /tmp/mynetwork.gnmap | grep -i up | cut -f 2 -d " " > up_hosts.txt
    
    cat /tmp/mynetwork.gnmap | grep -i down | cut -f 2 -d " " > down_hosts.txt



---

### 3. Scan Multiple Subnets or Networks

Perform ping scans on different CIDR ranges:

    nmap -sn 8.8.8.8/24
    
    nmap -sn 27.7.251.0/24
    
    nmap -sn 43.255.154.0/24

---

### 4. Skip DNS Resolution to Speed Up Scan

Avoid looking up DNS names for faster scanning of large subnets:

    nmap -sn -n 192.168.1.1/24


---

### 5. Scan Targets from Input File

Prepare a file (e.g., ip.txt) with a list of IP addresses or hostnames:

    192.168.1.1
    192.168.1.10
    192.168.1.31


Scan hosts from the file:

    nmap -v -iL ip.txt


---


# 6. Treat All Hosts as Online (Skip Host Discovery)

- Useful when firewall or IDS blocks ping probes:

      nmap -v -Pn 43.255.154.9

- Deprecated synonym for -Pn

      nmap -v -P0 192.168.1.1


---------------

# 7. Use Custom Ping Probes on Specific Ports

- Send TCP SYN probes ( -PS ) to specified ports:

      nmap -v -PS80 43.255.154.9

      nmap -v -sn -PS21,22,23,25,80,110,443 43.255.154.9


- Send TCP ACK probes ( -PA ):

      nmap -v -PA80 43.255.154.9

      nmap -v -sn -PA21,22,23,25,80,110,443 43.255.154.9

-  Send UDP probes ( -PU ):

       nmap -v -PU53,67,68,69 43.255.154.9


- Send SCTP INIT probes ( -PY ):

      nmap -v -PY80 43.255.154.9


-  Send ICMP Echo request probes ( -PE ), Timestamp request ( -PP ), or Netmask request ( -PM ):

       nmap -v -PE 43.255.154.9


- Send SCTP INIT probes ( -PY ):

      nmap -v -PY80 43.255.154.9


- Send ICMP Echo request probes ( -PE ), Timestamp request ( -PP ), or Netmask request ( -PM ):

      nmap -v -PE 43.255.154.9

      nmap -v -PP 43.255.154.9

      nmap -v -PM 43.255.154.9


-  IP Protocol Ping (-PO) Host Discovery

- The -PO option sends IP protocol ping probes to discover live hosts based on which IP protocols they respond to.
- Example command scanning the 8.8.8.0/24 subnet with IP Protocol Ping:

      nmap -v -sn -PO 8.8.8.0/24


Explanation:
- -v : verbose output to see scan details
- -sn : ping scan only (no port scan)
- -PO : IP protocol ping, sending probes of various IP protocols (other than just ICMP, TCP, UDP)

This option can discover hosts even if ICMP or TCP/UDP are blocked, by detecting support for other protocols like IGMP or GRE.

Use cases:
- Situations where standard ping scans are blocked by firewalls or IDS
- Specialized network reconnaissance requiring protocol-level host discovery

Note: Requires root/privileged access to send raw IP packets.


# 8. Excluding Hosts and Ranges from Scan

- Exclude IPs or subnets to avoid scanning certain hosts:

      nmap -v 192.168.1.1/24 --exclude 192.168.1.1-25
      
      nmap -v 192.168.1.1/24 --excludefile excluded.txt
      
      nmap -v 192.168.1.1/24 --exclude 192.168.1.52-100,250


# 9. Advanced Host Discovery Tips

- Extract Top Ports for TCP, UDP, and SCTP from Nmap services list to perform targeted ping scans:

      awk '$2~/tcp$/ {print $1}' /usr/share/nmap/nmap-services | sort -r -k3 | head -n 20 | awk -F '/tcp/' '{print $1}' | awk '{print $2}' | tr '\n' ','
      
      awk '$2~/udp$/ {print $1}' /usr/share/nmap/nmap-services | sort -r -k3 | head -n 20 | awk -F '/udp/' '{print $1}' | awk '{print $2}' | tr '\n' ','
      
      awk '$2~/sctp$/ {print $1}' /usr/share/nmap/nmap-services | sort -r -k3 | head -n 100 | awk -F '/sctp/' '{print $1}' | awk '{print $2}' | tr '\n' ','


- Combine aggressive ping scans to maximize host discovery under difficult conditions:

      nmap -v -sn -PS80,23,443,21,22,25,3389,110,445,139,143,53,135,3306,8080 82.196.42.195


# Summary

Nmap host discovery offers a rich suite of options and probes to adapt to any network environment or security context. Whether using simple ICMP pings or sophisticated TCP/UDP/SCTP probes, excluding certain hosts, or working with input files, these techniques improve scan accuracy and efficiency.

Use these commands to tailor discovery to your network's characteristics and security posture. For any custom scenarios or further help with scripting automated scans, feel free to ask!
