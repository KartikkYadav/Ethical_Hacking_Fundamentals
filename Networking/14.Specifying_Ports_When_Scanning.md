# Specifying Ports When Scanning

## Common ways to specify ports:

- Single or multiple ports:

      nmap -p 21 192.168.1.35
      nmap -p 21,22,25,80,443 192.168.1.35


- Port ranges and multiple ranges:

      nmap -p 1-200 192.168.1.35
      nmap -p 1-200,443,5000-5050 192.168.1.35


- Scan all 65,535 TCP ports:

      nmap -p- 192.168.1.31


- Separate TCP and UDP ports explicitly:

      nmap -p T:80,443,U:53,161 192.168.1.51
      nmap -sU -p T:80,443,U:53,161 192.168.1.235
      nmap -sT -sU -p T:80,443,U:53,161 192.168.1.235


- Scan only the top N most common ports:

      nmap --top-ports 20 192.168.1.31


### Exclude Ports

Avoid scanning specific ports by excluding them, useful when targeting sensitive or noisy services:

    nmap -p- --exclude-ports 9100 192.168.1.105
    nmap -p 79-99 --exclude-ports 80,83,85 192.168.1.51


### Port Name Patterns

- You can specify ports by service name or with wildcards:

      nmap -p http,ftp,smb 192.168.1.1
      nmap -p ^http 192.168.1.31
      nmap -p 'ftp*' 192.168.1.31


### Filtering Ports by Open Frequency

The --port-ratio option filters ports based on their open-frequency.

- Scan only ports with open-frequency â‰¥ 6%:

      nmap --port-ratio 0.06 192.168.1.207


- Set ratio to zero or omit to disable filtering and scan all available ports.

### Handling Special Ports (e.g., Printers)

- Port 9100 (printer services) is known to "print" any payload, causing noise in version detection.
- Nmap excludes such ports by default during version detection, but can be forced with --allports.

### Combining TCP and UDP Scans on Specific Ports

Example scanning both TCP and UDP common service ports:

    nmap -v -sU -sT -p T:80,23,443,21,22,25,U:53,161,137,123 192.168.1.51


### Examples of Top Ports Lists (Partial)

#### Top 20 TCP Ports
80, 443, 23, 21, 22, 25, 3389, 110, 445, 139, ...

#### Top 20 UDP Ports
53, 161, 67, 68, 137, 123, 990, 69, 510, ...

### Summary

- Nmap intelligently orders port scans using open-frequency data, prioritizing common ports.
- You can fully customize port scanning using lists, ranges, exclusions, and protocol-specific selections.
- Special ports and noisy services are handled gracefully with exclusion or manual control.
- Combining TCP and UDP scans helps comprehensively map service availability.
- The knowledge is essential for efficient and targeted network scanning using Nmap.

If you want, I can help build optimized commands tailored to your scan objectives or network environment!
