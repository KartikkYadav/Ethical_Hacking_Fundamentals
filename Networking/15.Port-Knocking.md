# Port-Knocking

## Port Knocking

Port knocking is a method for externally opening ports on a firewall by attempting to connect to a predefined sequence of closed ports. When the correct "knock" sequence is received, the firewall temporarily opens a specific port for the client’s IP address, allowing access to services such as SSH or RDP.

## How Port Knocking Works

1. **Default State:** All ports required for sensitive services (e.g., SSH) are closed and inaccessible from the public.
2. **Knock Sequence:** The client sends connection attempts (usually TCP, UDP, or ICMP) to a series of specific closed ports in a predefined order.
3. **Detection:** A port knocking daemon running on the server detects the correct sequence.
4. **Temporary Access:** The firewall dynamically opens the desired port for the client’s IP address for a limited period.
5. **Access Service:** The client connects to the now-open port (e.g., can now SSH into the server).
6. **Timeout/Cleanup:** After a set period or after connection closes, the port is closed again for that IP.

## Example Scenario

- Knock sequence: 1234, 2345, 3456
- The client “knocks” on ports 1234, 2345, then 3456—in this exact order.
- The firewall notices the sequence and opens port 22 (SSH) for the client’s IP for a set time window.
- After gaining access and connecting, port 22 closes again after a timeout.

## Security Benefits & Considerations

- **Conceals open ports** from automated scans and attacks.
- Reduces attack surface (ports appear closed unless the correct sequence is used).
- **Obfuscation, not encryption:** Port knocking is best used alongside additional security (e.g., SSH keys, VPN).

## Common Port Knocking Tools

1. Default State: All ports required for sensitive services (e.g., SSH) are closed and inaccessible from the public.

2. Knock Sequence: The client sends connection attempts (usually TCP, UDP, or ICMP) to a series of specific closed ports in a predefined order.

3. Detection: A port knocking daemon running on the server detects the correct sequence.

4. Temporary Access: The firewall dynamically opens the desired port for the client’s IP address for a limited period.

5. Access Service: The client connects to the now-open port (e.g., can now SSH into the server).

6. Timeout/Cleanup: After a set period or after connection closes, the port is closed again for that IP.


# Example Scenario

- Knock sequence: 1234, 2345, 3456
- The client “knocks” on ports 1234, 2345, then 3456—in this exact order.
- The firewall notices the sequence and opens port 22 (SSH) for the client’s IP for a set time window.
- After gaining access and connecting, port 22 closes again after a timeout.

# Security Benefits & Considerations

- **Conceals open ports** from automated scans and attacks.
- Reduces attack surface (ports appear closed unless the correct sequence is used).
- **Obfuscation, not encryption:** Port knocking is best used alongside additional security (e.g., SSH keys, VPN).

# Common Port Knocking Tools

- knockd (popular on Linux)
- fwknop
- simple-knock
