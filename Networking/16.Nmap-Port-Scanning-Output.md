# Nmap-Port-Scanning-Output

## Nmap Port Scanning & Output

This guide explains how Nmap detects port states along with useful commands and examples for practical penetration testing & network recon.

---

# Port States (TCP SYN Scan)

## ‚úÖ Open Port

### Process:
1. Client (SYN) ‚ü∂ Server
2. Client ‚ü∑ (SYN/ACK) Server
3. Client (RST) ‚ü∂ Server

### Meaning: 
Application listens on port.

### Tip:
RST avoids completing the connection ‚Üí used in half-open scans.

---

## ‚ùå Closed Port

### Process:
1. Client (SYN) ‚ü∂ Server
2. Client ‚ü∑ (RST/ACK) Server

### Meaning: 
No service running, but host is reachable.

---

## üõ°Ô∏è Filtered Port

### Process:
1. Client (SYN) ‚ü∂ Server
2. (no response)

---

## Explanation:
The client sends a SYN packet to the target port, but no reply is received within a timeout period. The absence of any response typically suggests that some intermediate device (such as a firewall, intrusion detection system, or packet filter) is blocking the probe packets. This filtering prevents the client from determining if the port is actually open or closed because the packet is dropped or silently ignored. This state reflects uncertainty ‚Äî Nmap cannot conclusively classify the port as open or closed due to the lack of feedback.

## Tip:
Sometimes filtered ports generate ICMP unreachable messages or other error responses, which Nmap can also interpret as filters. Distinguishing between "filtered" and "no response" can provide clues about network security controls in place.

## üìú Common Nmap Commands

## Basic Scans

- Simple scan  
  `nmap 192.168.1.46`
- Verbose output  
  `nmap -v 192.168.1.46`
- Max verbosity  
  `nmap -vvv 192.168.1.46`
- Debug mode (internal details)  
  `nmap -d 192.168.1.36`

## Port Selection

- Scan top 50 common ports  
  `nmap -v 192.168.1.46 --top-ports 50`
- Scan top 50 common ports  
  `nmap -v 192.168.1.51 --top-ports 50`
- Show only open ports  
  `nmap -v 192.168.1.51 --top-ports 50 --open`
- Scan FTP port 21 with explanation  
  `nmap -p 21 192.168.1.35 --reason`
- Scan FTP port 21 with explanation  
  `nmap -p 21 192.168.1.51 --reason`
- View packet flow in detail  
  `nmap -v 192.168.1.36 -p 80 --packet-trace`

## Output Control

- Normal text output  
  `nmap -v 192.168.1.36 -oN windowsserver.nmap`
- XML output  
  `nmap -v 192.168.1.36 -oX windowsserver.xml`
- Scripting output  
  `nmap -v 192.168.1.36 -oS windowsserver.scri`
- Grep-friendly  
  `nmap -v 192.168.1.36 -oG windowsserver.grepable`
- All formats at once (.nmap, .xml, .gnmap)  
  `nmap -v 192.168.1.36 -oA winserver`
- Append instead of overwrite  
  `nmap 192.168.1.36 -oN winserver.nmap --append-output`


## üì¶ Batch & Resume Scans

### ‚Ä¢ Scan Large Subnet

    nmap 157.191.64.0/18 -oN n1

- Resume Interrupted Scan

      nmap --resume n1

### üìÑ Custom Reports

- Convert XML Output into HTML

      xsltproc 1.xml -o 1.html

- Apply Bootstrap Stylesheet for Rich HTML

      nmap -v -sV -A -sC 192.168.1.1/24 \
      - -stylesheet https://raw.githubusercontent.com/honze-net/nmap-bootstrap-xsl/master/nmap-bootstrap.xsl \
      -oX mynetwork.xml

### üîç Parsing with Grep & Sed

- Extract Open Ports from .gnmap Results

      egrep -v "^#|Status: Up" nmap-out.gnmap \
      | cut -d ' ' -f4- \
      | sed -n -e 's/Ignored.*//p' \
      | tr ',' '\n' \
      | egrep -v 'closed|filtered' \
      | sed -e 's/^ [ \t]*//' \
      | sort -n | uniq -c | sort -k 1 -r

### üí° Practical Tips

- Use --reason ‚Üí See why Nmap marked port as open/closed/filtered.

- Add --packet-trace ‚Üí View every packet Nmap sends/receives.

- Use --top-ports for quick scans, -p- for full scans (all 65,535 ports).

- Combine with -sV (service/version detection) and -A (aggressive: OS + traceroute + script scan).
