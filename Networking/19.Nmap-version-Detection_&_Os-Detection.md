# Service-Version-Detection

## Service Version Detection (`-sV`)

The **Service Version Detection** (`-sV`) scan allows Nmap to determine detailed information about the software running on open ports, including application names, version numbers, device types, and specific protocol features.

---

## How the -sV Scan Works

### Initial Port Scan

- Nmap first performs standard scans (e.g., SYN or TCP scans) to find open ports.

### Probing Open Ports

Sends protocol-specific requests, such as:
- Banner grabbing (capturing greeting messages)
- Protocol commands (e.g., SMTP `HELO`, HTTP `GET /`)
- TLS/SSL handshakes to detect encryption details

### Analyzing Responses

- Compares responses against its extensive **service and version database**.
- If no exact match is found, Nmap makes an educated guess based on heuristics.

---

## Port Status Identification Examples

| Port      | Service     | Version                       |
|-----------|-------------|-------------------------------|
| 22/tcp    | OpenSSH     | OpenSSH 8.4p1 Ubuntu          |
| 80/tcp    | Apache      | Apache httpd 2.4.41           |
| 443/tcp   | Nginx       | Nginx 1.18.0                  |
| 8080/tcp  | unknown     | Possibly a web server         |

---

## Advantages of Service Version Detection (`-sV`)

- **Accurate Identification**: Detects specific services and versions running on a target.
- **Vulnerability Assessment**: Helps map known exploits to detected software versions.
- **Custom Probes**: Supports extensible probes for new or custom services.

---

## Disadvantages of Service Version Detection (`-sV`)

- **May Trigger Security Alerts**: Aggressive probing can be detected by IDS/IPS.
- **Not Always 100% Accurate**: Services may lie about their version or obscure banners.
- **Slower Scans**: Probing adds time, especially with many open ports.

---

## Use Cases

- Reconnaissance to identify running applications and versions.
- Penetration testing for vulnerability detection.
- Checking for outdated or misconfigured services.

---

## Example Commands

-  Verbose TCP Connect scan on port 80

       nmap -v -sT -p 80 192.168.1.51


- Verbose TCP Connect scan on port 23

      nmap -v -sT -p 23 192.168.1.51

- Service version detection on host 192.168.1.51

      nmap -sV 192.168.1.51


- Service version detection on ports 22, 80, and 443 of example.com

      nmap -sV -p 22,80,443 example.com


- Verbose TCP Connect scan with light version detection on port 80

      nmap -v -sT -sV --version-light -p 80 192.168.1.51


- Verbose TCP Connect scan with full version detection on port 80

      nmap -v -sT -sV --version-all -p 80 192.168.1.51

- Version detection with moderate intensity (3) on port 80

      nmap -v -sT -sV --version-intensity 3 -p 80 192.168.1.51

- Version detection with maximum intensity (9) on port 80

      nmap -v -sT -sV --version-intensity 9 -p 80 192.168.1.51

- Maximum intensity version detection on default ports

      nmap -sV --version-intensity 9 192.168.1.51


- Full version detection on all open ports on target.com

      nmap -sV --version-all target.com

- Service Version Detection with Banner Script on 192.168.1.51

      nmap -sV --script=banner 192.168.1.51


- Verbose No-Ping TCP Connect Scan with Version Detection and Banner Script on Port 80

      nmap -v -Pn -sT -sV --script=banner -p 80 192.168.1.51


- Verbose Scan on All Ports on Host 192.168.1.51

      nmap -v -p- 192.168.1.51


- Verbose TCP Connect Scan on All Ports

      nmap -v -sT -p- 192.168.1.51

- Verbose No-Ping Scan on All Ports


      nmap -v -Pn -p- 192.168.1.51

- Full TCP Connect Scan with Service Version Detection on All Ports

      nmap -sT -sV -p- 192.168.1.51

This feature enriches Nmap's port scanning by adding application-level service insights integral to thorough network security assessments.

Please ask if you would like explanations on combining `-sV` with scripting or performance tuning options!

----------------

# Operating-System-Detection

## Operating System Detection (`-O`)

The **OS Detection (`-O`)** feature of Nmap identifies the operating system running on a target machine by sending specially crafted packets and analyzing responses against a large database of OS fingerprints.

---

## How the -O Scan Works

### 1. Initial Port Scan
- Nmap scans for open and closed ports since OS detection requires at least **one open and one closed** port.

### 2. Sending Probes
- Sends TCP, UDP, and ICMP probes to analyze packet structure, responses, TTL, window sizes, and other OS-specific characteristics.

### 3. Matching Fingerprints
- Compares responses to Nmap's OS fingerprint database.
- Provides exact OS, or a best guess with confidence scores, based on matches.

---

## Example Output

    nmap -O 192.168.1.51


undefined

    Starting Nmap 7.94 ( https://nmap.org ) at 2025-02-14 14:32 IST
    Nmap scan report for 192.168.1.51
    Host is up (0.0050s latency).
    Not shown: 998 filtered ports
    PORT STATE SERVICE
    22/tcp open ssh
    80/tcp open http

OS details: Linux 5.4 - 5.11 (Ubuntu), Windows Server 2019, or FreeBSD 12
Network Distance: 1 hop


---

## Port Status and OS Detection

| Status           | Description                                                             |
|------------------|------------------------------------------------------------------------|
| Exact Detection  | Sufficient data found; OS displayed with confidence.                    |
| Guessing         | Partial matches yield a best guess with confidence %                    |
| Failed Detection | Insufficient data (e.g. all ports filtered), OS detection unreliable    |

---

## Advantages of OS Detection (`-O`)

- Provides detailed OS fingerprinting for reconnaissance.
- Helps in asset management by tracking device OS versions.
- Assists vulnerability assessments by targeting specific OS weaknesses.

---

## Disadvantages of OS Detection (`-O`)

- Requires at least one open and one closed port; may fail if ports are filtered.
- Potentially triggers IDS/IPS monitoring and alerts.
- OS fingerprinting can be inaccurate if targets use custom or obscured network stacks.

---

## Use Cases

- Identifying OS versions during penetration tests.
- Assessing network security by discovering outdated OS software.
- Testing firewall and IDS evasion techniques.

---

## Common Protocols, Kernel, and OS Examples

| Protocol Number | Service   | Kernel               | OS Examples                               |
|-----------------|-----------|----------------------|-------------------------------------------|
| 1               | ICMP      | Linux Kernel 5.x     | Linux (Ubuntu, Debian, CentOS)            |
| 6               | TCP       | Windows NT Kernel    | Windows 10, Windows Server 2019           |
| 17              | UDP       | FreeBSD Kernel       | FreeBSD 12.x                              |
| 47              | GRE       | Linux Kernel 4.x     | VPN Tunnels, Cisco Routers                |
| 50              | ESP       | Linux Kernel 5.x     | IPSec VPN on Linux                        |
| 51              | AH        | OpenBSD Kernel       | OpenBSD 6.x (Firewalls)                   |
| 58              | ICMPv6    | Linux Kernel 6.x     | IPv6 Networking (Ubuntu, RHEL)            |
| 89              | OSPF      | Cisco IOS Kernel     | Cisco Routers and Switches                |

---

## Example Commands

    - nmap -O 192.168.1.51
    
    - nmap -O --osscan-guess example.com
    
    - nmap -O --osscan-limit 10.10.10.10
    
    - nmap -O -v 192.168.1.1
    
    - nmap -vv -sV -sT -O -p- 192.168.1.44
    
    - nmap -vv -sV -sT -O -p 80 192.168.1.44
    
    - nmap -v -sT -sV -O --osscan-limit -p 445 192.168.1.51
    
    - nmap -v -sT -sV -O -p 445 --osscan-guess 192.168.1.51
    
    - nmap -v -sT -sV -O --osscan-guess 192.168.1.51
    
    - nmap -vv -sV -sT -O -A -p- 192.168.1.44
    
    - nmap -v -sT -sV -O -A -sC -p- 192.168.1.51
    
    - nmap -v -Pn -sT -sV -sC -A -O -p 21,23,40,53,135,139,443,445,3306,3389,5985,7878,8000,8008,33060,47001,49152,49153,49154,49155,49156,49157,49158,49159,49164,49165 192.168.1.51


This detailed OS detection process helps build comprehensive reconnaissance profiles for security testing.

Let me know if you want insights on combining OS detection with other Nmap features!
