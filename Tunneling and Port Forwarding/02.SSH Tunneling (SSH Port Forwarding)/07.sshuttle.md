# sshuttle - Transparent Proxy / VPN over SSH

**Repo:** https://github.com/sshuttle/sshuttle  
**Requirement:** Must run as root or via sudo (iptables / firewall rules)

---

## ğŸ“Œ Lab Setup

- **Target (Jump / Pivot Host):** `192.168.2.253` Debian  and windows internal network 192.168.3.250,192.168.3.251,192.168.3.253
- **Attacker:** `192.168.2.233` Kali

---

## âš™ï¸ Installation
    apt update
    apt install sshuttle

### Check help:
    sshuttle --help

## ğŸ”Œ Basic Connection (No Traffic Routed)
Just verifies SSH connectivity

    sshuttle -vNHr root@192.168.2.253

### Flags
- -v â†’ verbose

- -N â†’ no subnet yet

- -H â†’ auto hosts file handling

# ğŸŒ Tunnel ALL Traffic (Full VPN-like)
    sshuttle -vr root@192.168.2.253 192.168.3.0/24
- Routes all IPv4 traffic via remote host
- Includes internet traffic

## ğŸš« Exclude Specific Traffic
### Exclude a single IP
    sshuttle -vr root@192.168.2.253 0.0.0.0/0 -x 192.168.2.21
### Exclude a subnet
    sshuttle -vr root@192.168.2.253 0.0.0.0/0 -x 192.168.2.0/24
## ğŸ¯ Tunnel Specific Subnets (Recommended for PT)
### Single subnet
    sshuttle -r root@192.168.2.253 192.168.3.250
### Multiple subnets
    sshuttle -r root@192.168.2.201 192.168.100.0/24 192.168.200.0/24
### âš¡ Daemon Mode + SSH Key
    sshuttle -D -r root@192.168.1.201 192.168.200.0/24 \
    --ssh-cmd "ssh -i /id_rsa"
- -D â†’ run in background (daemon)

## ğŸŒ Forward DNS Queries (Important for Internal Apps)
    sshuttle --dns -vr root@192.168.1.201 192.168.200.0/24
### Verify
    curl http://192.168.200.26
### ğŸ” Scanning via Tunnel
    httpx -u http://192.168.200.26 \
    -ports 1-65535 \
    -title -web-server -tech-detect -location
### Verbose Mode
    httpx -u http://192.168.200.26 \
    -ports 1-65535 \
    -title -web-server -tech-detect -location -v
## ğŸ§  DNS Only + No Subnet (Rare Case)
    sshuttle --dns -vNHr root@192.168.1.201
## ğŸ” Sudoers Handling (No Modification)

    sshuttle --sudoers-no-modify --sudoers-user armour \
    -r root@192.168.1.201 192.168.200.0/24

### Use this when:
- You donâ€™t want sshuttle to modify /etc/sudoers
- You already have sudo access

## ğŸ“Œ Best Practices (PT / Red Team)
- Prefer specific subnets instead of 0.0.0.0/0
- Always test with:
   - curl
   - ping
   - ip route
## Combine with:
- proxychains â†’ for non-TCP tools
- nmap -Pn â†’ avoid ICMP dependency

