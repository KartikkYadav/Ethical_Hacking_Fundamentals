# SSH Local Port Forwarding

**SSH Local Port Forwarding** allows you to forward a port on your **local machine** to a service running on a **remote/internal network** through an SSH server.

---

## Use Case

- Access internal services (HTTP, DB, admin panels) that are **not directly reachable**
- Common in **pivoting during penetration testing**
- Traffic is **encrypted over SSH**

---

## Syntax

    ssh -L [LOCAL_PORT]:[DESTINATION_HOST]:[DESTINATION_PORT] user@SSH_SERVER

### Basic Example

    ssh -L 8080:192.168.1.100:80 user@remote_host

### Explanation

- Local machine listens on localhost:8080
- Traffic is forwarded to 192.168.1.100:80 via remote_host
- Access via browser:

      http://localhost:8080

## Lab Scenario

### Network Layout
- Attacker (Kali): 192.168.2.233
- SSH Pivot / Target: 192.168.2.253
- Internal Web Server: 192.168.3.250:80

### SSH Tunnel Flow

 
                     SSH Tunnel
      +-----------------------+    -------------------->    +-----------------------+
      |       Attacker        |                             |       SSH Server      |
      |     (Kali Linux)      |                             |      (Pivot Host)     |
      |                       |                             |                       |
      |  IP: 192.168.2.253    |                             |  IP: 192.168.2.253    |
      |                       |                             |                       |
      |  localhost:8080       |                             |                       |
      +-----------+-----------+                             +-----------+-----------+
                  |                                                           |
                  |                 Forwarded Traffic                         |
                  |                                                           |
                  |                                                           v
                  |                                           +---------------------------+
                  |                                           |     Internal Service      |
                  |                                           |                           |
                  |                                           |  192.168.3.150:80         |
                  |                                           +---------------------------+


### Command

    ssh -N -L 8080:192.168.3.250:80 debian@192.168.2.253

### Access

    http://localhost:8080

## Local Port Forwarding via Pivot Host

    ssh -L 8080:192.168.3.250:80 debian@192.168.2.253

### Result
Service 192.168.3.250:80 becomes available on:

    http://localhost:8080

### Using -N (No Remote Shell)

    ssh -N -L 8080:192.168.3.250:80 debian@192.168.2.253

### Why -N?
- No interactive shell
- Used only for tunneling
- Cleaner and safer during port forwarding

### Binding to a Specific Local IP
Useful when other hosts need access to the forwarded service.

    ssh -N -L 192.168.2.233:80:192.168.3.250:80 debian@192.168.2.252

### Forwarding Local Port 80 to Internal Services

    ssh -N -L 80:127.0.0.1:80 debian@192.168.2.253
    ssh -N -L 192.168.2.233:80:192.168.3.250:80 debian@192.168.2.253
    ssh -N -L 8080:192.168.3.250:8080 debian@192.168.2.253  

⚠ Ports below 1024 require root privileges

    sudo ssh -N -L 80:192.168.2.2:80 armour@192.168.1.71

## Key Points
- LOCAL_PORT → Port on attacker machine
- DESTINATION_HOST:DESTINATION_PORT → Internal service
- SSH_SERVER → Pivot host with access to internal network
- -N → No shell, tunneling only
- Traffic is encrypted end-to-end

